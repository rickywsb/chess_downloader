# Chess Downloader - 国际象棋教练工具

专为国际象棋教练设计的班级管理和棋谱下载工具。

## 功能特点

- 📋 **班级管理** - 创建、管理多个班级
- 👥 **学员管理** - 批量导入、编辑学员信息  
- 🎯 **对阵表解析** - 智能解析各种格式的对阵表
- 📥 **棋谱下载** - 自动从Chess.com下载学员棋谱
- 📊 **进度跟踪** - 详细的下载报告和状态显示
- ✅ 支持自动监测和批量下载
- ✅ 两种工作模式：简单模式（API）和高级模式（网页抓取）

## 文件说明

- `students.json` - 学员信息数据库（姓名 -> chess.com用户名）
- `chess_downloader_simple.py` - 简单模式脚本（推荐使用）
- `chess_downloader_pro.py` - 高级模式脚本（需要Chrome浏览器）
- `config.json` - 配置文件
- `start.sh` - 启动脚本
- `requirements.txt` - Python依赖包列表

## 快速开始

### 1. 运行启动脚本
```bash
./start.sh
```

### 2. 或者直接运行简单模式
```bash
python3 chess_downloader_simple.py
```

## 使用步骤

### 第一步：更新学员信息
- 运行脚本后，选择是否更新学员用户名
- 可以添加新学员或修改现有学员的 chess.com 用户名

### 第二步：输入轮次和对阵表
- 输入比赛轮次（如：5）
- 粘贴对阵表，支持以下格式：
  ```
  1 Edwin - Raymond 
  2 Yuchen - Zelan
  3 Henry - Li Xing 
  4 Eason - Junhan
  5 Stephen - Ryan
  ```
- 输入 `done` 完成

### 第三步：确认并下载
- 程序会解析对阵表并显示匹配的学员
- 确认后开始下载对局文件
- 文件保存在 `round_X` 文件夹中

## 对阵表格式说明

程序支持多种对阵表格式：

**格式1：带编号**
```
1 Edwin - Raymond 
2 Yuchen Lee - Zelan
3 Henry Wu - Li Xing 
```

**格式2：纯姓名**
```
Edwin - Raymond
Yuchen Lee - Zelan
Henry Wu - Li Xing
```

**格式3：中文格式**
```
第5轮比赛对阵表：
1 Edwin - Raymond 
2 Yuchen - Zelan
```

## 两种工作模式

### 简单模式（推荐）
- 使用 chess.com 的公开 API
- 更快速、更稳定
- 无需浏览器
- 受 API 限制，可能无法获取最新对局

### 高级模式
- 使用网页抓取技术
- 需要安装 Chrome 浏览器
- 可以获取最新对局
- 支持自动监测功能
- 受网站反爬虫限制影响

## 输出文件

每轮比赛会创建一个文件夹（如 `round_5`），包含：

- `学员1_vs_学员2.pgn` - 成功下载的对局文件
- `学员1_vs_学员2_NOT_FOUND.txt` - 未找到对局的说明文件

## 注意事项

1. **网络连接**：需要稳定的互联网连接访问 chess.com
2. **用户名准确性**：确保 chess.com 用户名正确无误
3. **时间范围**：程序搜索当前月和上个月的对局
4. **频率限制**：避免过于频繁的请求，程序已加入延时
5. **隐私保护**：仅下载公开的对局信息

## 常见问题

**Q: 为什么有些对局下载不到？**
A: 可能原因：
- 对局尚未结束
- 对局设置为私人可见
- 用户名不匹配
- 对局时间超出搜索范围

**Q: 如何添加新学员？**
A: 运行程序时选择更新学员信息，输入新学员姓名和对应的 chess.com 用户名

**Q: 程序卡住不动怎么办？**
A: 按 Ctrl+C 终止程序，检查网络连接后重新运行

## 技术支持

如遇问题，请检查：
1. Python 环境是否正确安装
2. 依赖包是否完整安装
3. 网络连接是否正常
4. chess.com 是否可正常访问

## 版本历史

- v1.0 - 基础功能实现
- v1.1 - 添加简单模式和高级模式
- v1.2 - 改进对阵表解析算法
- v1.3 - 添加自动监测功能

---

祝您使用愉快！🏆
